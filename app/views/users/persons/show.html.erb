<div class="main-container">
  <div class="profile-container">
    <div class="profile-box">
      <table class="table table-borderless">
        <tr>
          <td colspan="3"><%= attachment_image_tag @user, :profile_image, fallback: "user_sample.jpg", size: '80x80', class:"profile-image" %></td>
          <td></td>
        </tr>
        <% if @user.id == current_user.id %>
          <tr>
            <td colspan="3"><%= link_to 'プロフィールを編集する', edit_person_path(@user), class: "input_btn2" %></td>
            <td></td>
          </tr>
          <tr>
            <td colspan="3"><%= link_to 'イベントを開催する', new_event_path, class: "input_btn2" %></td>
            <td></td>
          </tr>
        <% end %>
        <tr>
          <th>NAME</th>
          <td><%= @user.name %></td>
        </tr>
        <tr>
          <th>AGE</th>
          <td><%= @user.age %></td>
        </tr>
        <tr>
          <th>PLOFILE</th>
          <td><%= safe_join(@user.introduction.split("\n"),tag(:br)) %></td>
        </tr>
        <% if @user.line.present? %>
          <tr>
            <th>LINE-ID</th>
            <td><%= @user.line %></td>
          </tr>
        <% end %>
        <tr>
          <% unless @user.id == current_user.id %>
            <th>DM</th>
            <td>
              <% if @isRoom == true %>
                <div class="link-room">
                  <%= link_to "Direct message", room_path(@roomId), class:"input_btn4" %>
                </div>
              <% else %>
                <div class="link-room">
                  <%= form_for @room do |f| %>
                    <%= fields_for @entry do |e| %>
                      <%= e.hidden_field :user_id, value: @user.id %>
                    <% end %>
                    <%= f.submit "Direct message", class:"input_btn4"%>
                  <% end %>
                </div>
              <% end %>
            </td>
          <% end %>
        </tr>
        <tr>
        <% if current_user != @user %>
          <th>違反通報</th>
          <td>
            <% if @user.reported_by?(current_user) %>
              <%= link_to "通報を取り消す", person_relationships_path(@user.id), method: :delete, class: "input_btn7" %>
            <% else %>
              <%= link_to "違反を通報する", person_relationships_path(@user.id), method: :post, class: "input_btn6" %>
            <% end %>
          </td>
        <% end %>
        </tr>
      </table>

      <div class="sns-link">
        <div>
          <% if @user.twitter.present? %>
            <%= link_to @user.twitter, target: :_new, class: "flowbtn8 fl_tw2" do %>
              <i class="fab fa-twitter"></i>
            <% end %>
          <% end %>
          <% if @user.instagram.present? %>
              <%= link_to @user.instagram, target: :_new, class: "flowbtn8 insta_btn2" do %>
                <i class="fab fa-instagram"></i>
              <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="user-event-container">
    <% @events.each do |event| %>
      <%= link_to event_path(event), class: "user-event-link" do %>
        <div class="user-event-box">
          <div>
            <%= attachment_image_tag event, :event_image, fallback: "no_event_image.jpg", size: '300x200', class: "event-img" %>
          </div>
          <div class="event-info">
            <p>開催日時：<%= event.date.strftime("%Y年%m月%d日") %></p>
            <p>開催エリア：<%= event.prefecture.name %></p>
            <p>イベント名：<%= event.title %></p>
          </div>
        </div>
      <% end %>
    <% end %>
    <%= paginate @events %>
  </div>
</div>